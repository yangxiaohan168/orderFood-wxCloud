<!--pages/admin/printer/printer.wxml-->
<view class="page">
  <!-- æ‰“å°æœºä¿¡æ¯å¡ç‰‡ -->
  <view class="printer-card" wx:if="{{printerInfo}}">
    <view class="card-header">
      <view class="printer-name">{{printerInfo.name || 'æœªå‘½åæ‰“å°æœº'}}</view>
      <view class="printer-status {{printerStatus.onlineStatus === 1 ? 'online' : 'offline'}}">
        {{printerStatus.onlineStatus === 1 ? 'åœ¨çº¿' : 'ç¦»çº¿'}}
      </view>
    </view>
    <view class="card-content">
      <view class="info-item">
        <text class="info-label">è®¾å¤‡ç¼–å·ï¼š</text>
        <text class="info-value">{{printerInfo.sn}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">å·¥ä½œçŠ¶æ€ï¼š</text>
        <text class="info-value">{{printerStatus.workStatusDesc || 'æœªçŸ¥'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ‰“å°æµ“åº¦ï¼š</text>
        <text class="info-value">{{densityText[printerInfo.density] || 'é»˜è®¤'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">æ‰“å°é€Ÿåº¦ï¼š</text>
        <text class="info-value">{{speedText[printerInfo.printSpeed] || 'é»˜è®¤'}}</text>
      </view>
      <view class="info-item">
        <text class="info-label">éŸ³é‡ï¼š</text>
        <text class="info-value">{{printerInfo.volume !== undefined ? printerInfo.volume : 'é»˜è®¤'}}</text>
      </view>
    </view>
    <view class="card-actions">
      <view class="action-btn test" bindtap="testPrint">æµ‹è¯•æ‰“å°</view>
      <view class="action-btn query" bindtap="queryStatus">æŸ¥è¯¢çŠ¶æ€</view>
      <view class="action-btn delete" bindtap="unbindPrinter">è§£ç»‘</view>
    </view>
  </view>

  <!-- æœªç»‘å®šçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <view class="empty-icon">ğŸ–¨ï¸</view>
    <view class="empty-text">æœªç»‘å®šæ‰“å°æœº</view>
    <view class="bind-btn" bindtap="showBindModal">ç»‘å®šæ‰“å°æœº</view>
  </view>

  <!-- è®¾ç½®åŒºåŸŸ -->
  <view class="settings-section" wx:if="{{printerInfo}}">
    <view class="section-title">æ‰“å°è®¾ç½®</view>
    
    <!-- æ‰“å°æµ“åº¦ -->
    <view class="setting-item">
      <view class="setting-label">æ‰“å°æµ“åº¦</view>
      <view class="setting-options">
        <view 
          class="option-btn {{printerInfo.density === 4 ? 'active' : ''}}"
          bindtap="setDensity"
          data-value="4">
          è¾ƒæ·¡
        </view>
        <view 
          class="option-btn {{printerInfo.density === 5 ? 'active' : ''}}"
          bindtap="setDensity"
          data-value="5">
          æ™®é€š
        </view>
        <view 
          class="option-btn {{printerInfo.density === 6 || !printerInfo.density ? 'active' : ''}}"
          bindtap="setDensity"
          data-value="6">
          è¾ƒæµ“
        </view>
        <view 
          class="option-btn {{printerInfo.density === 7 ? 'active' : ''}}"
          bindtap="setDensity"
          data-value="7">
          æµ“
        </view>
      </view>
    </view>

    <!-- æ‰“å°é€Ÿåº¦ -->
    <view class="setting-item">
      <view class="setting-label">æ‰“å°é€Ÿåº¦</view>
      <view class="setting-options">
        <view 
          class="option-btn {{printerInfo.printSpeed === 1 ? 'active' : ''}}"
          bindtap="setPrintSpeed"
          data-value="1">
          æ…¢
        </view>
        <view 
          class="option-btn {{printerInfo.printSpeed === 2 ? 'active' : ''}}"
          bindtap="setPrintSpeed"
          data-value="2">
          ä¸­
        </view>
        <view 
          class="option-btn {{printerInfo.printSpeed === 3 ? 'active' : ''}}"
          bindtap="setPrintSpeed"
          data-value="3">
          å¿«
        </view>
      </view>
    </view>

    <!-- éŸ³é‡ -->
    <view class="setting-item">
      <view class="setting-label">éŸ³é‡</view>
      <view class="setting-options">
        <view 
          class="option-btn {{printerInfo.volume === 0 ? 'active' : ''}}"
          bindtap="setVolume"
          data-value="0">
          é™éŸ³
        </view>
        <view 
          class="option-btn {{printerInfo.volume === 1 ? 'active' : ''}}"
          bindtap="setVolume"
          data-value="1">
          1
        </view>
        <view 
          class="option-btn {{printerInfo.volume === 2 ? 'active' : ''}}"
          bindtap="setVolume"
          data-value="2">
          2
        </view>
        <view 
          class="option-btn {{printerInfo.volume === 3 ? 'active' : ''}}"
          bindtap="setVolume"
          data-value="3">
          3
        </view>
        <view 
          class="option-btn {{printerInfo.volume === 4 ? 'active' : ''}}"
          bindtap="setVolume"
          data-value="4">
          4
        </view>
        <view 
          class="option-btn {{printerInfo.volume === 5 ? 'active' : ''}}"
          bindtap="setVolume"
          data-value="5">
          5
        </view>
      </view>
    </view>
  </view>

  <!-- ç»‘å®šæ‰“å°æœºå¼¹çª— -->
  <view class="modal-mask" wx:if="{{showBindModal}}" catchtap="closeBindModal">
    <view class="modal-dialog" catchtap="stopPropagation">
      <view class="modal-title">ç»‘å®šæ‰“å°æœº</view>
      <view class="modal-content">
        <view class="form-item">
          <view class="form-label">è®¾å¤‡ç¼–å· (SN)</view>
          <input 
            class="form-input" 
            placeholder="è¯·è¾“å…¥æ‰“å°æœºç¼–å·" 
            value="{{bindForm.sn}}"
            bindinput="onSnInput"
          />
        </view>
        <view class="form-item">
          <view class="form-label">ç»‘å®šç  (Key)</view>
          <input 
            class="form-input" 
            placeholder="è¯·è¾“å…¥è®¾å¤‡ç»‘å®šç " 
            value="{{bindForm.key}}"
            bindinput="onKeyInput"
          />
        </view>
        <view class="form-item">
          <view class="form-label">è®¾å¤‡åç§°</view>
          <input 
            class="form-input" 
            placeholder="è¯·è¾“å…¥è®¾å¤‡åç§°ï¼ˆå¯é€‰ï¼‰" 
            value="{{bindForm.name}}"
            bindinput="onNameInput"
          />
        </view>
      </view>
      <view class="modal-footer">
        <view class="modal-btn cancel" bindtap="closeBindModal">å–æ¶ˆ</view>
        <view class="modal-btn confirm" bindtap="confirmBind">ç¡®è®¤</view>
      </view>
    </view>
  </view>
</view>

